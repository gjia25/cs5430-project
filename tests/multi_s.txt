// Authors: Linda Huang (sh837), Grace Jia (gj75) for CS5430 Fall 2021

This testing document tests the analyzer's ability to enforce discretionary access
control for multiple subjects on a single object. 

********************************************************************************
Test 1: incremental R/W Add for multiple subjects

// a write privilege added to s2 should not affect write privileges of s1
// as they are two different subjects 
Add, s1, o1, R
Query, s1, o1, W
Add, s2, o1, W
Query, s1, o1, W
Query, s2, o1, W

********************************************************************************
Test 2: T Add for multiple subjects 

// s1 can take the write privileges of s2 to o1, so even though it was not 
// explicitly given the priv to write to o1, it is now authorized to do so
Add, s1, s2, T
Query, s1, s2, T
Query, s1, o1, W

********************************************************************************
Test 3: Authorized accesses given Cyclic Take relations

// s1 can augment its privileges with those of s2, now s2 can also augment its
// privileges with those of s1
// Previously it was unable to read o1, now it should be able to
Query, s2, o1, R
Add, s2, s1, T
Query, s2, s1, T
Query, s2, o1, R

********************************************************************************
Test 4: Unauthorized accesses given Cyclic Take relations

// both s3 and s4 are unable to write to o1, even after a take relation is introduced
Add, s3, o1, R
Query, s4, o1, W
Add, s4, s3, T
Query, s4, s3, T
Query, s4, o1, W

// Now a cyclic take relation is introduced
Add, s3, s4, T
Query, s3, s4, T
Query, s3, o1, W
Query, s4, o1, W

********************************************************************************
Test 5: Authorized accesses with multiple degrees of separation

Add, s5, o1, R
Query, s8, o1, R
Add, s6, s5, T
Add, s7, s6, T
Add, s8, s7, T
Query, s8, o1, R

// tests directionality of the take command
// s5 is not authorized to take privileges from s6, even though s6 is authorized
// to take privileges from it, and thus still cannot write to o1
Query, s8, o1, W
Add, s6, o1, W
Query, s5, o1, W
Query, s7, o1, W
Query, s8, o1, W

********************************************************************************
Test 6: Incremental Adds with Multiple objects

// s11 is allowed to write to o2 
Add, s11, o3, R
Add, s12, o4, W
Add, s11, s12, T
Query, s11, o3, R
Query, s11, o3, W 
Query, s11, s12, T
Query, s11, o4, W